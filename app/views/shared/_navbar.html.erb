<nav class="bg-surface border-b border-border sticky top-0 z-50 backdrop-blur-sm bg-surface/95" data-controller="dropdown">
  <div class="container-xl mx-auto px-4">
    <div class="flex items-center justify-between h-16">
      <!-- Logo -->
      <%= link_to root_path, class: "flex items-center gap-2 group" do %>
        <%= image_tag "app-logo.png", alt: "Kulawyer Logo", class: "w-8 h-8 rounded-lg object-contain" %>
        <span class="font-heading text-xl font-bold gradient-primary bg-clip-text text-transparent">
          <%= Rails.application.config.x.appname %>
          <span class="text-xs text-muted ml-1 font-normal">v1.0.1</span>
        </span>
      <% end %>
      
      <!-- Menu Links -->
      <div class="flex items-center gap-6">
        <div class="hidden md:flex items-center gap-6">
          <%= link_to resources_path, class: "text-sm text-secondary hover:text-primary transition-colors font-medium" do %>
            直达资源
          <% end %>
          <button data-controller="wechat-qr-trigger" data-action="click->wechat-qr-trigger#show" class="btn-primary btn-sm inline-flex items-center gap-2">
            <%= lucide_icon "plus", class: "w-4 h-4" %>
            提交工具
          </button>
        </div>
        
        <!-- Mobile Menu Button -->
        <button class="md:hidden p-2 text-secondary hover:text-primary transition-colors" 
                data-dropdown-target="trigger" 
                data-action="click->dropdown#toggle"
                aria-label="Toggle menu">
          <%= lucide_icon "menu", class: "w-6 h-6" %>
        </button>
      </div>
    </div>
    
    <!-- Mobile Search (Visible on mobile) -->
    <div class="lg:hidden pb-3">
      <%= form_with url: tools_path, method: :get, class: "relative" do |f| %>
        <%= lucide_icon "search", class: "absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted" %>
        <%= f.text_field :q, 
            placeholder: "搜索法律AI工具...", 
            class: "w-full pl-10 pr-4 py-2 bg-surface-elevated border border-border rounded-lg text-sm text-primary focus:outline-none focus:border-primary transition-all" %>
      <% end %>
    </div>
    
    <!-- Mobile Menu -->
    <div class="md:hidden hidden border-t border-border" data-dropdown-target="menu">
      <div class="py-4 space-y-3">
        <%= link_to categories_path, class: "block px-4 py-2 text-sm text-secondary hover:text-primary hover:bg-surface-elevated rounded-lg transition-colors font-medium" do %>
          分类
        <% end %>
        <%= link_to resources_path, class: "block px-4 py-2 text-sm text-secondary hover:text-primary hover:bg-surface-elevated rounded-lg transition-colors font-medium" do %>
          资源
        <% end %>
        <button data-controller="wechat-qr-trigger" data-action="click->wechat-qr-trigger#show" class="block mx-4 text-center btn-primary btn-sm inline-flex items-center justify-center gap-2">
          <%= lucide_icon "plus", class: "w-4 h-4" %>
          提交工具
        </button>
      </div>
    </div>
  </div>
</nav>

<!-- WeChat QR Code Modal (Body Level) -->
<div data-controller="wechat-qr">
  <div data-wechat-qr-target="modal" 
       data-action="click->wechat-qr#closeOnOutsideClick"
       class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999] flex items-center justify-center p-4">
    <div class="bg-surface rounded-2xl shadow-2xl max-w-lg w-full p-10 relative animate-in fade-in zoom-in duration-200">
      <!-- Close Button -->
      <button data-action="click->wechat-qr#hide" 
              class="absolute top-4 right-4 text-muted hover:text-primary transition-colors">
        <%= lucide_icon "x", class: "w-6 h-6" %>
      </button>
      
      <!-- Content -->
      <div class="text-center space-y-8">
        <div class="space-y-2">
          <h3 class="text-2xl font-bold text-primary">提交工具</h3>
          <p class="text-secondary">扫码添加创始人微信，直连镐赞提交您的工具</p>
        </div>
        
        <!-- QR Code -->
        <div class="flex justify-center py-4">
          <%= image_tag "founder-wechat-qr.png", 
              alt: "创始人镐赞微信二维码", 
              class: "w-80 h-80 rounded-xl border-4 border-primary/20 shadow-lg" %>
        </div>
        
        <div class="space-y-2 text-sm text-muted">
          <p class="flex items-center justify-center gap-2">
            <%= lucide_icon "user", class: "w-4 h-4" %>
            <span>创始人：镐赞</span>
          </p>
          <p>期待与您的交流！</p>
        </div>
      </div>
    </div>
  </div>
</div>
